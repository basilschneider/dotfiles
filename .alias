#!/usr/bin/env bash

# Cannot make ls a function, otherwise it would call itself
alias ls='ls --color=auto'
unalias ll
ll(){
    ls -l "${@}"
}
la(){
    ls -a "${@}"
}
lla(){
    ls -la "${@}"
}
alias grep='grep --color=auto'
alias egrep='egrep --color=auto'
alias less='less -N'
alias diff='diff -u'

rgrep(){
    local pattern="${1:-pattern}"
    shift 1
    grep \
        -Ir \
        --exclude-dir=.svn \
        --exclude-dir=.git \
        --exclude-dir=InstallArea \
        --exclude-dir=WorkArea \
        --exclude=*.make \
        --exclude=*.d \
        --exclude=*.asetup* \
        --exclude=.Session.vim \
        --exclude=build.out \
        "${pattern}" "$@"
}

mkcd(){
    mkdir "${1}" && cd "${1}"
}

# Always exec startx, so if the GUI crashes, the terminal exits
alias sx='exec startx'

# Start keepass with my kdb file
alias mykeepass="keepass ~/Documents/keepass/all.kdbx"

# My favourite format for date (used for the logs)
mydate(){
    date +"%F_%H-%M-%S"
}
export -f mydate

# Always show Monday as first day of the week in cal
alias cal="cal -m"

# Function that checkes if an element is in an array
# Usage: contains "${arr1[@]}" "${arr2[@]}" element
# Returns true when element is in arr1 or arr2, otherwise returns false
contains(){
    # Number of arguments
    local n=$#
    # Value of element to be searched
    local value=${!n}
    # Loop over arrays (but not over element (last positional argument))
    for ((i=1;i < $#;i++)){
        if [ "${!i}" == "${value}" ]; then
            echo "true"
            return 0
        fi
    }
    echo "false"
    return 1
}

eosSetup(){
    . /afs/cern.ch/project/eos/installation/atlas/etc/setup.sh
}
export -f eosSetup

# Voms alias with long validity
voms(){
    voms-proxy-init -voms atlas --valid 96:00
}

alias mocp='/usr/bin/mocp-scrobbler.py -d; mocp'

# not working on lxplus, probably due to old version of tput
nowrap(){
    (tput rmam;
     "${@}";
     tput smam)
}
